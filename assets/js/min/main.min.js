var VideomailClient=require("videomail-client"),DEBUG=!1,VideomailFieldController=Marionette.Object.extend({videomailClient:null,initialize:function(){Backbone.Radio.DEBUG=DEBUG,this.listenTo(Backbone.Radio.channel("videomail"),"init:model",this.registerVideomailField)},registerVideomailField:function(e){var i=e.get("formID");this.loadVideomailClient(e),Backbone.Radio.channel("videomail").reply("validate:required",this.validateRequired,this),Backbone.Radio.channel("videomail").reply("validate:modelData",this.validateVideomail,this),Backbone.Radio.channel("form-"+i).reply("maybe:submit",this.maybeSubmit,this,e),Backbone.Radio.channel("videomail").reply("get:submitData",this.getSubmitData,this)},loadVideomailClient:function(e){this.videomailClient=new VideomailClient({siteName:e.get("site_name"),video:{limitSeconds:e.get("limit_seconds")||80,width:e.get("width")||320,countdown:e.get("countdown")||!1},audio:{enabled:e.get("audio_enabled")||!1},selectors:{submitButtonSelector:'.submit-container input[type="button"]'},enableAutoValidation:!1,verbose:e.get("verbose")||DEBUG}),this.videomailClient.on(this.videomailClient.events.PREVIEW,function(i){console.log("VIDEOMAIL: PREVIEW"),console.log(i),e.set("videomail-key",i),Backbone.Radio.channel("fields").request("remove:error",e.get("id"),"required-error")}),this.videomailClient.on(this.videomailClient.events.GOING_BACK,function(){console.log("VIDEOMAIL: GOING BACK")}),this.videomailClient.on(this.videomailClient.events.SUBMITTED,function(i){var t=e.get("formID"),o=nfRadio.channel("app").request("get:form",t);nfRadio.channel("form-"+o.get("id")).request("add:extra","generatedVideomail",i),nfRadio.channel("form-"+t).request("submit",o)}),this.videomailClient.show()},validateRequired:function(e,i){var t=this.validateVideomail(i);return t||Backbone.Radio.channel("fields").request("add:error",i.get("id"),"required-error","Record and click on stop to see a preview video."),t},validateVideomail:function(e){return e.get("videomail-key")||!1},maybeSubmit:function(e){return!!e.getExtra("generatedVideomail")||(this.videomailClient.submit(),!1)},onBeforeDestroy:function(){this.videomailClient.unload()}});jQuery(document).ready(function(){new VideomailFieldController});
//# sourceMappingURL=main.min.js.map
